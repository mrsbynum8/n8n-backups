{
  "updatedAt": "2026-02-21T19:51:33.069Z",
  "createdAt": "2026-01-25T23:20:43.283Z",
  "id": "ZYwVA9WqrGwDHT59WQN-F",
  "name": "002-A. Script to Image Prep (Google Doc ‚Üí Chapters Sheet)",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {},
      "id": "144bba60-8f76-420e-a32f-b0e9cba2ac6c",
      "name": "Manual Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -1168,
        32
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "doc-id",
              "name": "document_id",
              "value": "={{ $json.doc_id }}",
              "type": "string"
            },
            {
              "id": "vid-name",
              "name": "=video_name",
              "value": "={{ $json.video_name }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "ea6d3b8e-c1ec-4f2e-a059-87d69907c50c",
      "name": "üìù EDIT THIS - Your Input",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -224,
        32
      ],
      "notes": "EDIT THESE VALUES:\n- document_id: The Google Doc ID from Workflow 0\n- video_name: Short name for spreadsheets (must match what you'll use in Workflow B)"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "={{ $json.document_id }}"
      },
      "id": "e03968b8-d464-4524-abc9-28ed52793399",
      "name": "Read Google Doc",
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        -16,
        32
      ],
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "0icadRz5XxXy9hB4",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// The content is already a string when using simple: true\nconst fullText = $input.item.json.content;\nconst videoName = $('üìù EDIT THIS - Your Input').item.json.video_name;\n\n// Split by section headers: # **Section N: Title**\nconst sectionRegex = /# \\*\\*Section (\\d+): ([^*]+)\\*\\*/g;\nconst sections = [];\nlet match;\nconst matches = [];\n\n// Find all section headers\nwhile ((match = sectionRegex.exec(fullText)) !== null) {\n  matches.push({\n    index: match.index,\n    fullMatch: match[0],\n    number: parseInt(match[1]),\n    title: match[2].trim()\n  });\n}\n\n// Extract content for each section\nfor (let i = 0; i < matches.length; i++) {\n  const currentMatch = matches[i];\n  const startIndex = currentMatch.index;\n  const endIndex = i < matches.length - 1 ? matches[i + 1].index : fullText.length;\n  \n  let sectionContent = fullText.substring(startIndex, endIndex).trim();\n  \n  // Remove the --- separator at the end if present\n  sectionContent = sectionContent.replace(/\\n---\\s*$/, '').trim();\n  \n  sections.push({\n    json: {\n      video_name: videoName,\n      chapter_number: currentMatch.number,\n      script: sectionContent,\n      status: 'pending'\n    }\n  });\n}\n\nif (sections.length === 0) {\n  throw new Error('No sections found. Make sure the document uses \"# **Section N: Title**\" format.');\n}\n\nreturn sections;"
      },
      "id": "665b9203-2437-46b6-b501-3a097443875b",
      "name": "Parse Sections",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        160,
        32
      ],
      "notes": "Splits the document by section headers and formats for spreadsheet"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
          "mode": "list",
          "cachedResultName": "SFS Topic Input Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1287119606,
          "mode": "list",
          "cachedResultName": "Chapters",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1287119606"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "video_name": "={{ $json.video_name }}",
            "chapter_number": "={{ $json.chapter_number }}",
            "script": "={{ $json.script }}",
            "status": "={{ $json.status }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "video_name",
              "displayName": "video_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "chapter_number",
              "displayName": "chapter_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "script",
              "displayName": "script",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "48358cc1-8b42-47e6-80e6-a983f0a786f6",
      "name": "Write to Chapters Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        560,
        32
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1XqTJPtDuzHpqQbs",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "summary",
              "name": "message",
              "value": "=‚úÖ Successfully wrote {{ $input.all().length }} sections to Chapters sheet",
              "type": "string"
            },
            {
              "id": "sections-count",
              "name": "sections_processed",
              "value": "={{ $input.all().length }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "id": "6214d944-d4ef-4ed4-9de3-596800ee54ed",
      "name": "Output Summary",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        432,
        -192
      ]
    },
    {
      "parameters": {
        "content": "## Workflow A: Script to Image Prep\n\n### What This Does\nReads a completed script from Google Docs and writes each section to your Image Generation spreadsheet's Chapters tab.\n\n### How to Use\n1. Get the document_id from Workflow 0's output (or from the Google Doc URL)\n2. Enter the same video_name you used in Workflow 0\n3. Run the workflow\n4. Check your Chapters sheet!\n\n### Then Run\nYour existing \"Prompt Generation\" workflow to generate image prompts from these chapters.",
        "height": 548,
        "width": 320,
        "color": 5
      },
      "id": "a193810b-cca1-4d78-99e0-7b26382febc9",
      "name": "Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1296,
        -96
      ]
    },
    {
      "parameters": {
        "jsCode": "// Google Sheets has a 50,000 character limit per cell\n// We'll use 45,000 as a safe buffer\nconst MAX_CHARS = 45000;\n\nconst allItems = [];\n\n// Function to find the best split point\nfunction findSplitPoint(text, maxLength) {\n  if (text.length <= maxLength) {\n    return text.length;\n  }\n  \n  // Try to split at a paragraph break (double newline)\n  const paragraphBreak = text.lastIndexOf('\\n\\n', maxLength);\n  if (paragraphBreak > maxLength * 0.8) { // Only use if it's at least 80% of max\n    return paragraphBreak + 2; // Include the newlines\n  }\n  \n  // Try to split at a sentence ending (. ! ? followed by space or newline)\n  const sentenceEndings = ['. ', '.\\n', '! ', '!\\n', '? ', '?\\n'];\n  let bestSplit = -1;\n  \n  for (const ending of sentenceEndings) {\n    const pos = text.lastIndexOf(ending, maxLength);\n    if (pos > bestSplit) {\n      bestSplit = pos + ending.length;\n    }\n  }\n  \n  if (bestSplit > maxLength * 0.8) { // Only use if it's at least 80% of max\n    return bestSplit;\n  }\n  \n  // Last resort: split at last space\n  const lastSpace = text.lastIndexOf(' ', maxLength);\n  if (lastSpace > 0) {\n    return lastSpace + 1;\n  }\n  \n  // Absolute last resort: hard cut (shouldn't happen with normal text)\n  return maxLength;\n}\n\n// Process each section from the previous node\nfor (const item of $input.all()) {\n  const script = item.json.script;\n  const videoName = item.json.video_name;\n  const chapterNumber = item.json.chapter_number;\n  const status = item.json.status;\n  \n  // If section is short enough, keep it as-is\n  if (script.length <= MAX_CHARS) {\n    allItems.push({\n      json: {\n        video_name: videoName,\n        chapter_number: chapterNumber,\n        script: script,\n        status: status\n      }\n    });\n  } else {\n    // Section is too long - split it into chunks at natural boundaries\n    let remaining = script;\n    let partNumber = 1;\n    \n    while (remaining.length > 0) {\n      const splitPoint = findSplitPoint(remaining, MAX_CHARS);\n      const chunk = remaining.substring(0, splitPoint).trim();\n      \n      // Format part number with leading zero (01, 02, etc.)\n      const paddedPart = String(partNumber).padStart(2, '0');\n      \n      allItems.push({\n        json: {\n          video_name: videoName,\n          chapter_number: `${chapterNumber}-${paddedPart}`,\n          script: chunk,\n          status: status\n        }\n      });\n      \n      remaining = remaining.substring(splitPoint).trim();\n      partNumber++;\n    }\n  }\n}\n\nreturn allItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        368,
        32
      ],
      "id": "d557eebd-122e-4a69-bd2c-fce1c9d73c6e",
      "name": "Split Long Sections"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
          "mode": "list",
          "cachedResultName": "SFS Topic Input Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "image_status",
              "lookupValue": "ready"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -896,
        32
      ],
      "id": "ca7652a6-4406-40a9-8749-e4b17a461f3d",
      "name": "Get row(s) in sheet",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1XqTJPtDuzHpqQbs",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "463a29d7-4688-4cb2-b6ad-d0904568413f",
              "leftValue": "={{ $json.row_number }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -688,
        32
      ],
      "id": "6124abde-f412-4ef2-ac54-0d0b9da11178",
      "name": "If"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -464,
        32
      ],
      "id": "ebccb3a5-e236-4dfc-bcc5-51bc64cd8d69",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
          "mode": "list",
          "cachedResultName": "SFS Topic Input Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "doc_id": "={{ $('Read Google Doc').item.json.documentId }}",
            "image_status": "chdone"
          },
          "matchingColumns": [
            "doc_id"
          ],
          "schema": [
            {
              "id": "topic",
              "displayName": "topic",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "video_name",
              "displayName": "video_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "target_words",
              "displayName": "target_words",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "script_type",
              "displayName": "script_type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "doc_id",
              "displayName": "doc_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "doc_link",
              "displayName": "doc_link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "date_completed",
              "displayName": "date_completed",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "voice_id",
              "displayName": "voice_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "image_status",
              "displayName": "image_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "tts_status",
              "displayName": "tts_status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -208,
        256
      ],
      "id": "73b8407d-0b7f-4345-b0fe-53e03b0d1bab",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1XqTJPtDuzHpqQbs",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "={{ $('Read Google Doc').item.json.documentId }}"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        -16,
        256
      ],
      "id": "2c597777-c59b-4d45-9a9a-991ea9a9c812",
      "name": "Get a document",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "0icadRz5XxXy9hB4",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openRouterApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"model\": \"anthropic/claude-sonnet-4.6\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are generating a complete SEO package for Scripture for Sleep, a YouTube channel creating 2-3 hour biblical sleep content.\\n\\nCHANNEL VOICE:\\n- Comedically appalled storyteller (like telling about a terrible Airbnb)\\n- Warm, amused, incredulous\\n- Second-person immersion: \\\"you wake up in 1200 BCE\\\"\\n- Modern vocabulary describing ancient absurdity\\n- Entertainingly disgusted by ancient living conditions\\n\\nGiven this script, generate the COMPLETE SEO PACKAGE following these exact templates:\\n\\n---\\n\\n## VIDEO TITLES (Provide exactly 3 options):\\n\\nTitles do one job: get found. They must be keyword-functional. Evocative language belongs in the thumbnail text, NOT the title.\\n\\nOption 1 (Brand Standard): Fall Asleep to [Topic] | Bible Stories for Sleep\\nOption 2 (Mystery Hook): Fall Asleep to [Topic] | Biblical Mysteries for Sleep\\nOption 3 (Complete Story): The Complete Story of [Subject] | Bible Stories for Sleep\\n\\nTitle rules:\\n- \\\"Bible Stories for Sleep\\\" must appear in every title as a brand anchor\\n- The topic name carries the search value ‚Äî keep it clear and recognizable\\n- Do NOT use evocative subtitles like \\\"The Man Who Spoke with God\\\" in titles ‚Äî that's thumbnail text's job\\n- Target 65-95 characters\\n- If the topic has strong search volume (Moses, David, Revelation), lead with the name\\n\\nWHAT NOT TO DO:\\n‚ùå \\\"Fall Asleep to Moses | The Man Who Spoke with God\\\" ‚Äî evocative subtitle wastes keyword space\\n‚úÖ \\\"Fall Asleep to Moses | Old Testament Bible Stories for Sleep\\\" ‚Äî every word is searchable\\n\\n---\\n\\n## VIDEO DESCRIPTION (250-350 words):\\n\\nHASHTAGS go at the very bottom of the description body. YouTube reads hashtags from the description ‚Äî do not put them in a separate field.\\n\\nDescription hook: The 2-3 sentence hook must reference something the casual viewer has already heard of ‚Äî a widely recognized name, concept, or event they're curious about but don't fully understand. NOT an obscure detail that only makes sense after watching.\\n\\n‚úÖ GOOD: \\\"The Four Horsemen of the Apocalypse. Most people have heard the phrase. Almost nobody knows what the Bible actually says they are.\\\"\\n‚ùå BAD: \\\"John was on Patmos when a voice spoke to him and changed everything.\\\" (meaningless without context)\\n\\nUse this exact template structure:\\n\\nFall asleep to the calm, in-depth story of [Topic]. This video contains NO mid-roll ads.\\n\\n[2-3 sentence hook ‚Äî reference something widely recognized that viewers are curious about but don't fully understand]\\n\\n‚è±Ô∏è CHAPTERS\\n00:00 - Introduction\\n[Extract chapter titles from the script sections and list them]\\n\\nüìñ IN THIS VIDEO\\nIn this documentary-style exploration, we cover:\\n‚Ä¢ [Key topic 1]\\n‚Ä¢ [Key topic 2]\\n‚Ä¢ [Key topic 3]\\n‚Ä¢ [Key topic 4]\\n‚Ä¢ [Key topic 5]\\n\\n[1-2 sentences about why this topic matters]\\n\\nPerfect for falling asleep, relaxation, study, or anyone curious about biblical history.\\n\\nüîî Subscribe for more: @ScriptureforSleepOfficial\\n\\nüéôÔ∏è Prefer screen-free listening? Find us on podcast platforms ‚Äî or play the full audio playlist here: https://www.youtube.com/playlist?list=PLnvFipPRN0NDhN9sFmX-IaurhpRRm1vUk\\n\\n‚ú® VIDEOS TO WATCH NEXT ‚ú®\\n[Link 1 ‚Äî most thematically related video]\\n[Link 2 ‚Äî second most related video]\\nüåô Full Playlist (put it on & fall asleep): https://www.youtube.com/playlist?list=PLnvFipPRN0NByOpwSz7__rf4gNXzRNPXQ\\n\\n[HASHTAGS ‚Äî paste full hashtag block here, see Section 4]\\n\\nIMPORTANT:\\n- Extract actual chapter titles from the script's section headers\\n- Output the ENTIRE DESCRIPTION in a markdown code block (```text) so emojis copy correctly\\n- Leave Link 1 and Link 2 in the Videos to Watch Next section as placeholder text ‚Äî they will be filled in manually\\n- The podcast link and Full Playlist link are hardcoded ‚Äî output them exactly as shown, every time\\n\\n---\\n\\n## VIDEO TAGS (Max 500 characters, SEPARATE FIELD):\\n\\nProvide ALL tags in a single comma-separated code block. Use all four layers below, prioritized in order. Trim from Layer 4 first if you need to fit the 500-character limit.\\n\\nLayer 1 ‚Äî Topic-Specific (always first, highest search value):\\n[topic] bible story, [topic] explained, story of [topic], [book] explained, [topic] kjv\\n\\nLayer 2 ‚Äî Brand & Channel:\\nbible stories for sleep, fall asleep to bible stories, scripture for sleep, sleep bible stories, relaxing bible stories, bible documentary, biblical history, bedtime bible, calm narration\\n\\nLayer 3 ‚Äî Abide App Targeting (always include ‚Äî captures paid-app audience seeking free alternative):\\nabide, abide bible stories, abide sleep meditation, abide app meditation, sleep in god's word, sleep with gods word, christian meditation for sleep\\n\\nLayer 4 ‚Äî Sleep & Wellness Discovery (trim here first if needed):\\nfall asleep fast, sleep better, sleep routine, mental health, insomnia relief, deep sleep, relaxing stories, sleep meditation, sleep stories\\n\\nAlso add: bible stories animated (people searching for animated content find audio and stay)\\n\\n---\\n\\n## HASHTAGS (20-25, placed at the bottom of the description body):\\n\\nThe first 3 hashtags appear above your video title in the YouTube UI ‚Äî make those the most important.\\n\\nPosition 1-3 (always these three, always first):\\n#BibleStories #[MainTopic] #ScriptureForSleep\\n\\nCore sleep/wellness layer (always include all of these):\\n#FallAsleepFast #SleepMeditation #InsomniaRelief #MentalHealth #DeepSleep #SleepWithScripture #BibleAudio #CalmingNarration #FaithAndRest #BedtimeBible\\n\\nDiscovery/category layer (always include all of these):\\n#BiblicalHistory #OldTestament #ChristianSleep #RestInGod #Abide\\n\\nTopic-specific layer (add 2-4 based on the script content):\\n#[MainTopic] #[SecondaryTopic] #[RelevantBiblicalConcept] #[RelevantEra]\\n\\nOutput all hashtags as a single unbroken block, no line breaks between them.\\n\\n---\\n\\n## THUMBNAIL CONCEPTS (Provide 3 concepts):\\n\\nFor each concept, provide:\\n\\n**CONCEPT [N]:**\\n**Scene:** [Brief description of the pivotal moment from the script]\\n**Composition:** Close-up, [subject] centered, face fills 40-50% of frame, [dramatic action] visible behind/around at smaller scale\\n**Era/Clothing:** [Specific time period and garments from this reference]\\n  - Egyptian (1200 BCE): Golden nemes headdress, uraeus cobra, white linen\\n  - Babylonian (6th century BCE): Ornate robes, gold embroidery\\n  - Persian (5th century BCE): Elaborate court dress, crown\\n  - Patriarchs (2000-1800 BCE): Bronze Age nomadic, wool robes\\n  - Judges (1100 BCE): Iron Age Israelite, linen, bronze armor\\n  - United Kingdom (1000 BCE): Iron Age Israelite king's robes\\n  - Prophets (850 BCE): Rough hairy prophet's cloak, simple wool\\n  - New Testament (1st century CE): Simple wool/linen robes\\n\\n**Thumbnail Text (for Canva overlay):**\\n- Line 1: MAIN TOPIC IN CAPS ‚Äî the widely recognized subject (e.g., \\\"MOSES\\\", \\\"THE NEPHILIM\\\", \\\"THE BOOK OF REVELATION\\\"). Something the viewer has already heard of. Never an obscure detail.\\n- Line 2: EVOCATIVE HOOK ‚Äî story-driven, curiosity-gap language that makes someone feel there's a narrative worth experiencing. This is where the channel's storytelling voice lives. Examples: \\\"The Man Who Spoke with God\\\" / \\\"The Brother They Left for Dead\\\" / \\\"The Night God Changed His Name\\\"\\n\\nNOTE: Line 2 does the job that evocative subtitles used to do in titles. It should stop the scroll, not describe the scene literally.\\n\\n**Full Image Prompt:**\\nFrameless digital painting, centered composition, CLOSE-UP SHOT,\\n[subject] from the chest up positioned in the CENTER of the frame,\\n[expression/action], face fills 40-50% of frame,\\nCLOTHING/ERA: [specific time period and garments],\\nDRAMATIC CONTEXT BEHIND/AROUND AT SMALLER SCALE: [epic scene],\\n[environmental details],\\n19th-century romantic oil painting style, Gustave Dor√© influence,\\n[subject] dominates foreground, [action] visible but secondary,\\nsymmetrical composition, no frame, no border, edge-to-edge\\n\\n---\\n\\n## PLAYLIST ASSIGNMENT:\\n\\nBased on the script content, specify which of the channel's 5 active playlists this video belongs in. A video can and should appear in multiple playlists if thematically appropriate. The Start Here full playlist receives every video automatically ‚Äî do not include it here.\\n\\nThe 5 active playlists and what belongs in each:\\n- üîç Biblical Mysteries & Hidden Knowledge ‚Üí forbidden texts, unexplained events, apocrypha, hidden figures, \\\"banned\\\" or \\\"secret\\\" or \\\"strange\\\" or \\\"mysteries\\\" angles\\n- üìñ The Complete Books ‚Üí full walkthroughs of individual biblical books\\n- üëº Angels, Demons & the Supernatural ‚Üí angels, fallen angels, Nephilim, Satan, visions, apocalyptic content, miracles\\n- üë• People of the Bible ‚Üí individual characters, character epics, compilations of biblical figures\\n- üèõÔ∏è The Ancient World ‚Üí daily life, historical context, what ancient life actually felt like\\n\\nAdditional mapping rules:\\n- Jesus content ‚Üí People of the Bible (+ Biblical Mysteries if mystery angle)\\n- Revelation ‚Üí The Complete Books + Angels, Demons & the Supernatural\\n- Characters with supernatural encounters ‚Üí People of the Bible + Angels, Demons & the Supernatural\\n- When in doubt, assign to more playlists rather than fewer\\n\\nOutput format:\\nüìã PLAYLIST ASSIGNMENT\\nAdd this video to:\\n‚úÖ [Playlist Name]\\n‚úÖ [Playlist Name] (if applicable)\\n‚úÖ [Playlist Name] (if applicable)\\n\\n---\\n\\nSCRIPT TO ANALYZE:\\n\" + JSON.stringify($json.content) + \"\\n\\n---\\n\\nGenerate the complete SEO package following the exact format above. Be specific, compelling, and base everything on the actual script content.\"\n    }\n  ]\n} }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        160,
        256
      ],
      "id": "6bb7784c-3e8a-473e-b50f-a91a59bbb6a3",
      "name": "HTTP Request",
      "credentials": {
        "openRouterApi": {
          "id": "VNgbdBR86ZkDETr5",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const seoResponse = $input.item.json.choices[0].message.content;\nconst videoName = $('üìù EDIT THIS - Your Input').item.json.video_name;\n\nreturn [{\n  json: {\n    video_name: videoName,\n    seo_package: seoResponse\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        384,
        256
      ],
      "id": "f2b71d4d-84c7-42a6-866b-ff034f8508b5",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C0AAHGKVD4L",
          "mode": "list",
          "cachedResultName": "sfs-video-assets"
        },
        "text": "=üé¨ **VIDEO ASSETS READY: {{ $json.video_name }}**\\n\\n‚úÖ Image prompts generated and ready in spreadsheet\\n‚úÖ SEO package generated\\n\\n---\\n\\n{{ $json.seo_package }}\\n\\n---\\n\\nüìä Check your Image Generation spreadsheet to review prompts before generating images!",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.4,
      "position": [
        560,
        256
      ],
      "id": "e7c52414-b897-4577-97df-e21598692e2b",
      "name": "Send a message",
      "webhookId": "48e110b2-7d44-4ead-990c-25d7fa04f920",
      "credentials": {
        "slackOAuth2Api": {
          "id": "eFTGhpy1vaGaNItw",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "path": "b5a36cfa-11d5-4d42-b46f-f2cd2953d118",
        "responseMode": "lastNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1168,
        208
      ],
      "id": "5088d06e-80d9-47fc-a2ae-845969936154",
      "name": "Webhook",
      "webhookId": "b5a36cfa-11d5-4d42-b46f-f2cd2953d118"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
          "mode": "list",
          "cachedResultName": "SFS Topic Input Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1287119606,
          "mode": "list",
          "cachedResultName": "Chapters",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1287119606"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "status",
              "lookupValue": "pending"
            }
          ]
        },
        "options": {}
      },
      "id": "da1fc627-46bd-443d-ba97-29da620046c9",
      "name": "Read Pending Chapters (Sheet1)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -416,
        752
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1XqTJPtDuzHpqQbs",
          "name": "Google Sheets account"
        }
      },
      "notes": "Reads pending chapters from Sheet1"
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "aa960fff-431b-4bf5-8f4e-07f29672cd3c",
      "name": "Loop Over Chapters",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -64,
        752
      ],
      "notes": "Process one chapter at a time"
    },
    {
      "parameters": {
        "jsCode": "const script = $input.item.json.script;\nconst chapterNumber = $input.item.json.chapter_number;\nconst wordCount = script.split(/\\s+/).length;\n\n// First section gets 2x image density (1 image per 30 words)\n// Other sections get standard density (1 image per 60 words)\nconst wordsPerImage = chapterNumber === 1 ? 49 : 175;\nconst imageCount = Math.round(wordCount / wordsPerImage);\n\nreturn [{\n  json: {\n    video_name: $input.item.json.video_name,\n    chapter_number: chapterNumber,\n    script: script,\n    image_count: imageCount,\n    row_number: $input.item.json.row_number\n  }\n}];"
      },
      "id": "43f7ac8d-382e-48bb-84a5-3d2d304d75fc",
      "name": "Calculate Image Count",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        288,
        624
      ],
      "notes": "word count √∑ 50"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openRouterApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "= {\n\n  \"model\": \"anthropic/claude-sonnet-4.6\",\n\n  \"messages\": [\n\n    {\n\n      \"role\": \"system\",\n\n     \"content\": \"You generate detailed watercolor painting image prompts for biblical contemplative sleep story videos. Each prompt MUST be 5+ sentences describing a dramatic, emotionally evocative watercolor scene.\\n\\nCRITICAL INSTRUCTION - CHRONOLOGICAL ORDER:\\n- Generate prompts in STRICT CHRONOLOGICAL ORDER following the script from beginning to end\\n- Each prompt should correspond to the narrative as it unfolds sequentially\\n- DO NOT jump around in the story or group similar themes together\\n- Follow the script paragraph by paragraph, section by section, in linear order\\n- The first prompt should depict the beginning of the script, the last prompt should depict the end\\n\\nSTYLE REQUIREMENTS:\\n- Dramatic Biblical watercolor painting style with soft, bleeding edges\\n- Contemplative, thoughtful, quietly beautiful tone\\n- Biblical/historical accuracy (Bronze Age settings, ancient clothing, period-appropriate materials)\\n- Deep purples, twilight blues, warm amber tones for nighttime atmosphere\\n- Focus on emotional weight, character expressions, symbolic elements\\n\\nCONTENT RESTRICTIONS (CRITICAL):\\n- NO violence, gore, blood, or weapons\\n- NO nudity or sexual content\\n- NO readable text or writing in images\\n- Use symbolic/atmospheric approaches when literal depictions would violate these rules\\n\\nOUTPUT FORMAT:\\nGenerate EXACTLY {{ $json.image_count }} prompts.\\nOutput ONLY a valid JSON array with no other text, markdown, or explanation:\\n[{\\\"prompt\\\": \\\"A Biblical watercolor painting of...\\\"}, {\\\"prompt\\\": \\\"A Biblical watercolor painting of...\\\"}]\\n\\nBase all prompts on the provided script IN THE ORDER IT IS WRITTEN.\"\n\n    },\n\n    {\n\n      \"role\": \"user\",\n\n      \"content\": {{ JSON.stringify($json.script) }}\n\n    }\n\n  ],\n\n  \"temperature\": 1,\n  \"max_tokens\": 28192\n\n} ",
        "options": {}
      },
      "id": "796e3dc3-7d62-48a0-85ea-624db13da506",
      "name": "Generate Prompts via OpenAI",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        496,
        624
      ],
      "credentials": {
        "openRouterApi": {
          "id": "VNgbdBR86ZkDETr5",
          "name": "OpenRouter account"
        }
      },
      "notes": "Creates all image prompts for this chapter"
    },
    {
      "parameters": {
        "jsCode": "const openaiResponse = $input.item.json.choices[0].message.content;\nlet prompts;\n\ntry {\n  prompts = JSON.parse(openaiResponse);\n} catch (e) {\n  const jsonMatch = openaiResponse.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    prompts = JSON.parse(jsonMatch[1]);\n  } else {\n    throw new Error(\"Could not parse OpenAI response as JSON\");\n  }\n}\n\nconst videoName = $('Loop Over Chapters').item.json.video_name;\nconst chapterNum = $('Loop Over Chapters').item.json.chapter_number;\nconst rowNumber = $('Loop Over Chapters').item.json.row_number;\n\n// Format for Sheet2 - each prompt as a separate row\nreturn prompts.map((p, index) => ({\n  json: {\n    video_name: videoName,\n    chapter_number: chapterNum,\n    image_number: String(index + 1).padStart(2, '0'),\n    filename: `${videoName}-${chapterNum}-${String(index + 1).padStart(2, '0')}.png`,\n    prompt: p.prompt,\n    status: 'pending',\n    chapter_row_number: rowNumber\n  }\n}));"
      },
      "id": "8e9e204a-5257-4ca8-adc4-ab58ec2ad123",
      "name": "Parse & Format for Sheet2",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        704,
        624
      ],
      "notes": "Formats each prompt as a row for Sheet2"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
          "mode": "list",
          "cachedResultName": "SFS Topic Input Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1502887379,
          "mode": "list",
          "cachedResultName": "Prompts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1502887379"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "video_name": "={{ $json.video_name }}",
            "chapter_number": "={{ $json.chapter_number }}",
            "image_number": "={{ $json.image_number }}",
            "filename": "={{ $json.filename }}",
            "prompt": "={{ $json.prompt }}",
            "status": "pending"
          },
          "matchingColumns": [
            "filename"
          ],
          "schema": [
            {
              "id": "video_name",
              "displayName": "video_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "chapter_number",
              "displayName": "chapter_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "image_number",
              "displayName": "image_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "filename",
              "displayName": "filename",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "prompt",
              "displayName": "prompt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "9c54ae8f-3968-41ba-85dd-1d8aa640f342",
      "name": "Write Prompts to Sheet2",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        288,
        848
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1XqTJPtDuzHpqQbs",
          "name": "Google Sheets account"
        }
      },
      "notes": "Appends all prompts to Sheet2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
          "mode": "list",
          "cachedResultName": "SFS Topic Input Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1287119606,
          "mode": "list",
          "cachedResultName": "Chapters",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1287119606"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "status": "completed",
            "row_number": "={{ $('Loop Over Chapters').item.json.row_number }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "video_name",
              "displayName": "video_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "chapter_number",
              "displayName": "chapter_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "script",
              "displayName": "script",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "567f7ea1-924b-4b0d-886c-28694a39ecc5",
      "name": "Mark Chapter Complete (Sheet1)",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        544,
        848
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1XqTJPtDuzHpqQbs",
          "name": "Google Sheets account"
        }
      },
      "notes": "Marks this chapter as completed in Sheet1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        288,
        464
      ],
      "id": "05420b1b-b47a-48af-890e-aa8fc352b847",
      "name": "Limit"
    },
    {
      "parameters": {
        "content": "## Workflow 1: Prompt Generation\n\n### What This Does:\n1. Reads pending chapters from Sheet1\n2. Calculates how many images needed (word count √∑ 50)\n3. Generates ALL prompts via OpenAI\n4. Writes prompts to Sheet2 with status='pending'\n5. Marks chapter as 'completed' in Sheet1\n\n### Sheet1 Columns:\nvideo_name, chapter_number, script, status, row_number\n\n### Sheet2 Columns:\nvideo_name, chapter_number, image_number, filename, prompt, status, row_number\n\n### Benefits:\n- Review/edit prompts before generating images\n- Separate prompt creation from expensive image generation\n- Only pay for image generation after reviewing prompts",
        "height": 532,
        "width": 440,
        "color": 5
      },
      "id": "75922f5b-59c2-40d2-a9e3-a8e6854e9d4c",
      "name": "Instructions1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1104,
        528
      ]
    }
  ],
  "connections": {
    "Manual Trigger": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìù EDIT THIS - Your Input": {
      "main": [
        [
          {
            "node": "Read Google Doc",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Google Doc": {
      "main": [
        [
          {
            "node": "Parse Sections",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Sections": {
      "main": [
        [
          {
            "node": "Split Long Sections",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Write to Chapters Sheet": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Long Sections": {
      "main": [
        [
          {
            "node": "Write to Chapters Sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Read Pending Chapters (Sheet1)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Read Pending Chapters (Sheet1)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üìù EDIT THIS - Your Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Get a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a document": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Pending Chapters (Sheet1)": {
      "main": [
        [
          {
            "node": "Loop Over Chapters",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Chapters": {
      "main": [
        [
          {
            "node": "Limit",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Calculate Image Count",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calculate Image Count": {
      "main": [
        [
          {
            "node": "Generate Prompts via OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Prompts via OpenAI": {
      "main": [
        [
          {
            "node": "Parse & Format for Sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse & Format for Sheet2": {
      "main": [
        [
          {
            "node": "Write Prompts to Sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Write Prompts to Sheet2": {
      "main": [
        [
          {
            "node": "Mark Chapter Complete (Sheet1)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mark Chapter Complete (Sheet1)": {
      "main": [
        [
          {
            "node": "Loop Over Chapters",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": true,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "206ed2f7-b251-4056-8be2-bb86158222a5",
  "activeVersionId": "206ed2f7-b251-4056-8be2-bb86158222a5",
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2026-01-25T23:20:43.287Z",
      "createdAt": "2026-01-25T23:20:43.287Z",
      "role": "workflow:owner",
      "workflowId": "ZYwVA9WqrGwDHT59WQN-F",
      "projectId": "eaD0haLSQbgJ93Hf"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-02-21T19:52:09.000Z",
    "createdAt": "2026-02-21T19:51:33.074Z",
    "versionId": "206ed2f7-b251-4056-8be2-bb86158222a5",
    "workflowId": "ZYwVA9WqrGwDHT59WQN-F",
    "nodes": [
      {
        "parameters": {},
        "id": "144bba60-8f76-420e-a32f-b0e9cba2ac6c",
        "name": "Manual Trigger",
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          -1168,
          32
        ]
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "doc-id",
                "name": "document_id",
                "value": "={{ $json.doc_id }}",
                "type": "string"
              },
              {
                "id": "vid-name",
                "name": "=video_name",
                "value": "={{ $json.video_name }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "id": "ea6d3b8e-c1ec-4f2e-a059-87d69907c50c",
        "name": "üìù EDIT THIS - Your Input",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -224,
          32
        ],
        "notes": "EDIT THESE VALUES:\n- document_id: The Google Doc ID from Workflow 0\n- video_name: Short name for spreadsheets (must match what you'll use in Workflow B)"
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "={{ $json.document_id }}"
        },
        "id": "e03968b8-d464-4524-abc9-28ed52793399",
        "name": "Read Google Doc",
        "type": "n8n-nodes-base.googleDocs",
        "typeVersion": 2,
        "position": [
          -16,
          32
        ],
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "0icadRz5XxXy9hB4",
            "name": "Google Docs account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// The content is already a string when using simple: true\nconst fullText = $input.item.json.content;\nconst videoName = $('üìù EDIT THIS - Your Input').item.json.video_name;\n\n// Split by section headers: # **Section N: Title**\nconst sectionRegex = /# \\*\\*Section (\\d+): ([^*]+)\\*\\*/g;\nconst sections = [];\nlet match;\nconst matches = [];\n\n// Find all section headers\nwhile ((match = sectionRegex.exec(fullText)) !== null) {\n  matches.push({\n    index: match.index,\n    fullMatch: match[0],\n    number: parseInt(match[1]),\n    title: match[2].trim()\n  });\n}\n\n// Extract content for each section\nfor (let i = 0; i < matches.length; i++) {\n  const currentMatch = matches[i];\n  const startIndex = currentMatch.index;\n  const endIndex = i < matches.length - 1 ? matches[i + 1].index : fullText.length;\n  \n  let sectionContent = fullText.substring(startIndex, endIndex).trim();\n  \n  // Remove the --- separator at the end if present\n  sectionContent = sectionContent.replace(/\\n---\\s*$/, '').trim();\n  \n  sections.push({\n    json: {\n      video_name: videoName,\n      chapter_number: currentMatch.number,\n      script: sectionContent,\n      status: 'pending'\n    }\n  });\n}\n\nif (sections.length === 0) {\n  throw new Error('No sections found. Make sure the document uses \"# **Section N: Title**\" format.');\n}\n\nreturn sections;"
        },
        "id": "665b9203-2437-46b6-b501-3a097443875b",
        "name": "Parse Sections",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          160,
          32
        ],
        "notes": "Splits the document by section headers and formats for spreadsheet"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
            "mode": "list",
            "cachedResultName": "SFS Topic Input Sheet",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": 1287119606,
            "mode": "list",
            "cachedResultName": "Chapters",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1287119606"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "video_name": "={{ $json.video_name }}",
              "chapter_number": "={{ $json.chapter_number }}",
              "script": "={{ $json.script }}",
              "status": "={{ $json.status }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "video_name",
                "displayName": "video_name",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "chapter_number",
                "displayName": "chapter_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "script",
                "displayName": "script",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "48358cc1-8b42-47e6-80e6-a983f0a786f6",
        "name": "Write to Chapters Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          560,
          32
        ],
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "1XqTJPtDuzHpqQbs",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "summary",
                "name": "message",
                "value": "=‚úÖ Successfully wrote {{ $input.all().length }} sections to Chapters sheet",
                "type": "string"
              },
              {
                "id": "sections-count",
                "name": "sections_processed",
                "value": "={{ $input.all().length }}",
                "type": "number"
              }
            ]
          },
          "options": {}
        },
        "id": "6214d944-d4ef-4ed4-9de3-596800ee54ed",
        "name": "Output Summary",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          432,
          -192
        ]
      },
      {
        "parameters": {
          "content": "## Workflow A: Script to Image Prep\n\n### What This Does\nReads a completed script from Google Docs and writes each section to your Image Generation spreadsheet's Chapters tab.\n\n### How to Use\n1. Get the document_id from Workflow 0's output (or from the Google Doc URL)\n2. Enter the same video_name you used in Workflow 0\n3. Run the workflow\n4. Check your Chapters sheet!\n\n### Then Run\nYour existing \"Prompt Generation\" workflow to generate image prompts from these chapters.",
          "height": 548,
          "width": 320,
          "color": 5
        },
        "id": "a193810b-cca1-4d78-99e0-7b26382febc9",
        "name": "Instructions",
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -1296,
          -96
        ]
      },
      {
        "parameters": {
          "jsCode": "// Google Sheets has a 50,000 character limit per cell\n// We'll use 45,000 as a safe buffer\nconst MAX_CHARS = 45000;\n\nconst allItems = [];\n\n// Function to find the best split point\nfunction findSplitPoint(text, maxLength) {\n  if (text.length <= maxLength) {\n    return text.length;\n  }\n  \n  // Try to split at a paragraph break (double newline)\n  const paragraphBreak = text.lastIndexOf('\\n\\n', maxLength);\n  if (paragraphBreak > maxLength * 0.8) { // Only use if it's at least 80% of max\n    return paragraphBreak + 2; // Include the newlines\n  }\n  \n  // Try to split at a sentence ending (. ! ? followed by space or newline)\n  const sentenceEndings = ['. ', '.\\n', '! ', '!\\n', '? ', '?\\n'];\n  let bestSplit = -1;\n  \n  for (const ending of sentenceEndings) {\n    const pos = text.lastIndexOf(ending, maxLength);\n    if (pos > bestSplit) {\n      bestSplit = pos + ending.length;\n    }\n  }\n  \n  if (bestSplit > maxLength * 0.8) { // Only use if it's at least 80% of max\n    return bestSplit;\n  }\n  \n  // Last resort: split at last space\n  const lastSpace = text.lastIndexOf(' ', maxLength);\n  if (lastSpace > 0) {\n    return lastSpace + 1;\n  }\n  \n  // Absolute last resort: hard cut (shouldn't happen with normal text)\n  return maxLength;\n}\n\n// Process each section from the previous node\nfor (const item of $input.all()) {\n  const script = item.json.script;\n  const videoName = item.json.video_name;\n  const chapterNumber = item.json.chapter_number;\n  const status = item.json.status;\n  \n  // If section is short enough, keep it as-is\n  if (script.length <= MAX_CHARS) {\n    allItems.push({\n      json: {\n        video_name: videoName,\n        chapter_number: chapterNumber,\n        script: script,\n        status: status\n      }\n    });\n  } else {\n    // Section is too long - split it into chunks at natural boundaries\n    let remaining = script;\n    let partNumber = 1;\n    \n    while (remaining.length > 0) {\n      const splitPoint = findSplitPoint(remaining, MAX_CHARS);\n      const chunk = remaining.substring(0, splitPoint).trim();\n      \n      // Format part number with leading zero (01, 02, etc.)\n      const paddedPart = String(partNumber).padStart(2, '0');\n      \n      allItems.push({\n        json: {\n          video_name: videoName,\n          chapter_number: `${chapterNumber}-${paddedPart}`,\n          script: chunk,\n          status: status\n        }\n      });\n      \n      remaining = remaining.substring(splitPoint).trim();\n      partNumber++;\n    }\n  }\n}\n\nreturn allItems;"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          368,
          32
        ],
        "id": "d557eebd-122e-4a69-bd2c-fce1c9d73c6e",
        "name": "Split Long Sections"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
            "mode": "list",
            "cachedResultName": "SFS Topic Input Sheet",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "image_status",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          -896,
          32
        ],
        "id": "ca7652a6-4406-40a9-8749-e4b17a461f3d",
        "name": "Get row(s) in sheet",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "1XqTJPtDuzHpqQbs",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 3
            },
            "conditions": [
              {
                "id": "463a29d7-4688-4cb2-b6ad-d0904568413f",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": 0,
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.3,
        "position": [
          -688,
          32
        ],
        "id": "6124abde-f412-4ef2-ac54-0d0b9da11178",
        "name": "If"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          -464,
          32
        ],
        "id": "ebccb3a5-e236-4dfc-bcc5-51bc64cd8d69",
        "name": "Loop Over Items"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
            "mode": "list",
            "cachedResultName": "SFS Topic Input Sheet",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "doc_id": "={{ $('Read Google Doc').item.json.documentId }}",
              "image_status": "chdone"
            },
            "matchingColumns": [
              "doc_id"
            ],
            "schema": [
              {
                "id": "topic",
                "displayName": "topic",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "video_name",
                "displayName": "video_name",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "target_words",
                "displayName": "target_words",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "script_type",
                "displayName": "script_type",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "doc_id",
                "displayName": "doc_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "doc_link",
                "displayName": "doc_link",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "date_completed",
                "displayName": "date_completed",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "voice_id",
                "displayName": "voice_id",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "image_status",
                "displayName": "image_status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "tts_status",
                "displayName": "tts_status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          -208,
          256
        ],
        "id": "73b8407d-0b7f-4345-b0fe-53e03b0d1bab",
        "name": "Update row in sheet",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "1XqTJPtDuzHpqQbs",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "={{ $('Read Google Doc').item.json.documentId }}"
        },
        "type": "n8n-nodes-base.googleDocs",
        "typeVersion": 2,
        "position": [
          -16,
          256
        ],
        "id": "2c597777-c59b-4d45-9a9a-991ea9a9c812",
        "name": "Get a document",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "0icadRz5XxXy9hB4",
            "name": "Google Docs account"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://openrouter.ai/api/v1/chat/completions",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "openRouterApi",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ {\n  \"model\": \"anthropic/claude-sonnet-4.6\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are generating a complete SEO package for Scripture for Sleep, a YouTube channel creating 2-3 hour biblical sleep content.\\n\\nCHANNEL VOICE:\\n- Comedically appalled storyteller (like telling about a terrible Airbnb)\\n- Warm, amused, incredulous\\n- Second-person immersion: \\\"you wake up in 1200 BCE\\\"\\n- Modern vocabulary describing ancient absurdity\\n- Entertainingly disgusted by ancient living conditions\\n\\nGiven this script, generate the COMPLETE SEO PACKAGE following these exact templates:\\n\\n---\\n\\n## VIDEO TITLES (Provide exactly 3 options):\\n\\nTitles do one job: get found. They must be keyword-functional. Evocative language belongs in the thumbnail text, NOT the title.\\n\\nOption 1 (Brand Standard): Fall Asleep to [Topic] | Bible Stories for Sleep\\nOption 2 (Mystery Hook): Fall Asleep to [Topic] | Biblical Mysteries for Sleep\\nOption 3 (Complete Story): The Complete Story of [Subject] | Bible Stories for Sleep\\n\\nTitle rules:\\n- \\\"Bible Stories for Sleep\\\" must appear in every title as a brand anchor\\n- The topic name carries the search value ‚Äî keep it clear and recognizable\\n- Do NOT use evocative subtitles like \\\"The Man Who Spoke with God\\\" in titles ‚Äî that's thumbnail text's job\\n- Target 65-95 characters\\n- If the topic has strong search volume (Moses, David, Revelation), lead with the name\\n\\nWHAT NOT TO DO:\\n‚ùå \\\"Fall Asleep to Moses | The Man Who Spoke with God\\\" ‚Äî evocative subtitle wastes keyword space\\n‚úÖ \\\"Fall Asleep to Moses | Old Testament Bible Stories for Sleep\\\" ‚Äî every word is searchable\\n\\n---\\n\\n## VIDEO DESCRIPTION (250-350 words):\\n\\nHASHTAGS go at the very bottom of the description body. YouTube reads hashtags from the description ‚Äî do not put them in a separate field.\\n\\nDescription hook: The 2-3 sentence hook must reference something the casual viewer has already heard of ‚Äî a widely recognized name, concept, or event they're curious about but don't fully understand. NOT an obscure detail that only makes sense after watching.\\n\\n‚úÖ GOOD: \\\"The Four Horsemen of the Apocalypse. Most people have heard the phrase. Almost nobody knows what the Bible actually says they are.\\\"\\n‚ùå BAD: \\\"John was on Patmos when a voice spoke to him and changed everything.\\\" (meaningless without context)\\n\\nUse this exact template structure:\\n\\nFall asleep to the calm, in-depth story of [Topic]. This video contains NO mid-roll ads.\\n\\n[2-3 sentence hook ‚Äî reference something widely recognized that viewers are curious about but don't fully understand]\\n\\n‚è±Ô∏è CHAPTERS\\n00:00 - Introduction\\n[Extract chapter titles from the script sections and list them]\\n\\nüìñ IN THIS VIDEO\\nIn this documentary-style exploration, we cover:\\n‚Ä¢ [Key topic 1]\\n‚Ä¢ [Key topic 2]\\n‚Ä¢ [Key topic 3]\\n‚Ä¢ [Key topic 4]\\n‚Ä¢ [Key topic 5]\\n\\n[1-2 sentences about why this topic matters]\\n\\nPerfect for falling asleep, relaxation, study, or anyone curious about biblical history.\\n\\nüîî Subscribe for more: @ScriptureforSleepOfficial\\n\\nüéôÔ∏è Prefer screen-free listening? Find us on podcast platforms ‚Äî or play the full audio playlist here: https://www.youtube.com/playlist?list=PLnvFipPRN0NDhN9sFmX-IaurhpRRm1vUk\\n\\n‚ú® VIDEOS TO WATCH NEXT ‚ú®\\n[Link 1 ‚Äî most thematically related video]\\n[Link 2 ‚Äî second most related video]\\nüåô Full Playlist (put it on & fall asleep): https://www.youtube.com/playlist?list=PLnvFipPRN0NByOpwSz7__rf4gNXzRNPXQ\\n\\n[HASHTAGS ‚Äî paste full hashtag block here, see Section 4]\\n\\nIMPORTANT:\\n- Extract actual chapter titles from the script's section headers\\n- Output the ENTIRE DESCRIPTION in a markdown code block (```text) so emojis copy correctly\\n- Leave Link 1 and Link 2 in the Videos to Watch Next section as placeholder text ‚Äî they will be filled in manually\\n- The podcast link and Full Playlist link are hardcoded ‚Äî output them exactly as shown, every time\\n\\n---\\n\\n## VIDEO TAGS (Max 500 characters, SEPARATE FIELD):\\n\\nProvide ALL tags in a single comma-separated code block. Use all four layers below, prioritized in order. Trim from Layer 4 first if you need to fit the 500-character limit.\\n\\nLayer 1 ‚Äî Topic-Specific (always first, highest search value):\\n[topic] bible story, [topic] explained, story of [topic], [book] explained, [topic] kjv\\n\\nLayer 2 ‚Äî Brand & Channel:\\nbible stories for sleep, fall asleep to bible stories, scripture for sleep, sleep bible stories, relaxing bible stories, bible documentary, biblical history, bedtime bible, calm narration\\n\\nLayer 3 ‚Äî Abide App Targeting (always include ‚Äî captures paid-app audience seeking free alternative):\\nabide, abide bible stories, abide sleep meditation, abide app meditation, sleep in god's word, sleep with gods word, christian meditation for sleep\\n\\nLayer 4 ‚Äî Sleep & Wellness Discovery (trim here first if needed):\\nfall asleep fast, sleep better, sleep routine, mental health, insomnia relief, deep sleep, relaxing stories, sleep meditation, sleep stories\\n\\nAlso add: bible stories animated (people searching for animated content find audio and stay)\\n\\n---\\n\\n## HASHTAGS (20-25, placed at the bottom of the description body):\\n\\nThe first 3 hashtags appear above your video title in the YouTube UI ‚Äî make those the most important.\\n\\nPosition 1-3 (always these three, always first):\\n#BibleStories #[MainTopic] #ScriptureForSleep\\n\\nCore sleep/wellness layer (always include all of these):\\n#FallAsleepFast #SleepMeditation #InsomniaRelief #MentalHealth #DeepSleep #SleepWithScripture #BibleAudio #CalmingNarration #FaithAndRest #BedtimeBible\\n\\nDiscovery/category layer (always include all of these):\\n#BiblicalHistory #OldTestament #ChristianSleep #RestInGod #Abide\\n\\nTopic-specific layer (add 2-4 based on the script content):\\n#[MainTopic] #[SecondaryTopic] #[RelevantBiblicalConcept] #[RelevantEra]\\n\\nOutput all hashtags as a single unbroken block, no line breaks between them.\\n\\n---\\n\\n## THUMBNAIL CONCEPTS (Provide 3 concepts):\\n\\nFor each concept, provide:\\n\\n**CONCEPT [N]:**\\n**Scene:** [Brief description of the pivotal moment from the script]\\n**Composition:** Close-up, [subject] centered, face fills 40-50% of frame, [dramatic action] visible behind/around at smaller scale\\n**Era/Clothing:** [Specific time period and garments from this reference]\\n  - Egyptian (1200 BCE): Golden nemes headdress, uraeus cobra, white linen\\n  - Babylonian (6th century BCE): Ornate robes, gold embroidery\\n  - Persian (5th century BCE): Elaborate court dress, crown\\n  - Patriarchs (2000-1800 BCE): Bronze Age nomadic, wool robes\\n  - Judges (1100 BCE): Iron Age Israelite, linen, bronze armor\\n  - United Kingdom (1000 BCE): Iron Age Israelite king's robes\\n  - Prophets (850 BCE): Rough hairy prophet's cloak, simple wool\\n  - New Testament (1st century CE): Simple wool/linen robes\\n\\n**Thumbnail Text (for Canva overlay):**\\n- Line 1: MAIN TOPIC IN CAPS ‚Äî the widely recognized subject (e.g., \\\"MOSES\\\", \\\"THE NEPHILIM\\\", \\\"THE BOOK OF REVELATION\\\"). Something the viewer has already heard of. Never an obscure detail.\\n- Line 2: EVOCATIVE HOOK ‚Äî story-driven, curiosity-gap language that makes someone feel there's a narrative worth experiencing. This is where the channel's storytelling voice lives. Examples: \\\"The Man Who Spoke with God\\\" / \\\"The Brother They Left for Dead\\\" / \\\"The Night God Changed His Name\\\"\\n\\nNOTE: Line 2 does the job that evocative subtitles used to do in titles. It should stop the scroll, not describe the scene literally.\\n\\n**Full Image Prompt:**\\nFrameless digital painting, centered composition, CLOSE-UP SHOT,\\n[subject] from the chest up positioned in the CENTER of the frame,\\n[expression/action], face fills 40-50% of frame,\\nCLOTHING/ERA: [specific time period and garments],\\nDRAMATIC CONTEXT BEHIND/AROUND AT SMALLER SCALE: [epic scene],\\n[environmental details],\\n19th-century romantic oil painting style, Gustave Dor√© influence,\\n[subject] dominates foreground, [action] visible but secondary,\\nsymmetrical composition, no frame, no border, edge-to-edge\\n\\n---\\n\\n## PLAYLIST ASSIGNMENT:\\n\\nBased on the script content, specify which of the channel's 5 active playlists this video belongs in. A video can and should appear in multiple playlists if thematically appropriate. The Start Here full playlist receives every video automatically ‚Äî do not include it here.\\n\\nThe 5 active playlists and what belongs in each:\\n- üîç Biblical Mysteries & Hidden Knowledge ‚Üí forbidden texts, unexplained events, apocrypha, hidden figures, \\\"banned\\\" or \\\"secret\\\" or \\\"strange\\\" or \\\"mysteries\\\" angles\\n- üìñ The Complete Books ‚Üí full walkthroughs of individual biblical books\\n- üëº Angels, Demons & the Supernatural ‚Üí angels, fallen angels, Nephilim, Satan, visions, apocalyptic content, miracles\\n- üë• People of the Bible ‚Üí individual characters, character epics, compilations of biblical figures\\n- üèõÔ∏è The Ancient World ‚Üí daily life, historical context, what ancient life actually felt like\\n\\nAdditional mapping rules:\\n- Jesus content ‚Üí People of the Bible (+ Biblical Mysteries if mystery angle)\\n- Revelation ‚Üí The Complete Books + Angels, Demons & the Supernatural\\n- Characters with supernatural encounters ‚Üí People of the Bible + Angels, Demons & the Supernatural\\n- When in doubt, assign to more playlists rather than fewer\\n\\nOutput format:\\nüìã PLAYLIST ASSIGNMENT\\nAdd this video to:\\n‚úÖ [Playlist Name]\\n‚úÖ [Playlist Name] (if applicable)\\n‚úÖ [Playlist Name] (if applicable)\\n\\n---\\n\\nSCRIPT TO ANALYZE:\\n\" + JSON.stringify($json.content) + \"\\n\\n---\\n\\nGenerate the complete SEO package following the exact format above. Be specific, compelling, and base everything on the actual script content.\"\n    }\n  ]\n} }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          160,
          256
        ],
        "id": "6bb7784c-3e8a-473e-b50f-a91a59bbb6a3",
        "name": "HTTP Request",
        "credentials": {
          "openRouterApi": {
            "id": "VNgbdBR86ZkDETr5",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const seoResponse = $input.item.json.choices[0].message.content;\nconst videoName = $('üìù EDIT THIS - Your Input').item.json.video_name;\n\nreturn [{\n  json: {\n    video_name: videoName,\n    seo_package: seoResponse\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          384,
          256
        ],
        "id": "f2b71d4d-84c7-42a6-866b-ff034f8508b5",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "authentication": "oAuth2",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "C0AAHGKVD4L",
            "mode": "list",
            "cachedResultName": "sfs-video-assets"
          },
          "text": "=üé¨ **VIDEO ASSETS READY: {{ $json.video_name }}**\\n\\n‚úÖ Image prompts generated and ready in spreadsheet\\n‚úÖ SEO package generated\\n\\n---\\n\\n{{ $json.seo_package }}\\n\\n---\\n\\nüìä Check your Image Generation spreadsheet to review prompts before generating images!",
          "otherOptions": {}
        },
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2.4,
        "position": [
          560,
          256
        ],
        "id": "e7c52414-b897-4577-97df-e21598692e2b",
        "name": "Send a message",
        "webhookId": "48e110b2-7d44-4ead-990c-25d7fa04f920",
        "credentials": {
          "slackOAuth2Api": {
            "id": "eFTGhpy1vaGaNItw",
            "name": "Slack account"
          }
        }
      },
      {
        "parameters": {
          "path": "b5a36cfa-11d5-4d42-b46f-f2cd2953d118",
          "responseMode": "lastNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -1168,
          208
        ],
        "id": "5088d06e-80d9-47fc-a2ae-845969936154",
        "name": "Webhook",
        "webhookId": "b5a36cfa-11d5-4d42-b46f-f2cd2953d118"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
            "mode": "list",
            "cachedResultName": "SFS Topic Input Sheet",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": 1287119606,
            "mode": "list",
            "cachedResultName": "Chapters",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1287119606"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "pending"
              }
            ]
          },
          "options": {}
        },
        "id": "da1fc627-46bd-443d-ba97-29da620046c9",
        "name": "Read Pending Chapters (Sheet1)",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          -416,
          752
        ],
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "1XqTJPtDuzHpqQbs",
            "name": "Google Sheets account"
          }
        },
        "notes": "Reads pending chapters from Sheet1"
      },
      {
        "parameters": {
          "options": {}
        },
        "id": "aa960fff-431b-4bf5-8f4e-07f29672cd3c",
        "name": "Loop Over Chapters",
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          -64,
          752
        ],
        "notes": "Process one chapter at a time"
      },
      {
        "parameters": {
          "jsCode": "const script = $input.item.json.script;\nconst chapterNumber = $input.item.json.chapter_number;\nconst wordCount = script.split(/\\s+/).length;\n\n// First section gets 2x image density (1 image per 30 words)\n// Other sections get standard density (1 image per 60 words)\nconst wordsPerImage = chapterNumber === 1 ? 49 : 175;\nconst imageCount = Math.round(wordCount / wordsPerImage);\n\nreturn [{\n  json: {\n    video_name: $input.item.json.video_name,\n    chapter_number: chapterNumber,\n    script: script,\n    image_count: imageCount,\n    row_number: $input.item.json.row_number\n  }\n}];"
        },
        "id": "43f7ac8d-382e-48bb-84a5-3d2d304d75fc",
        "name": "Calculate Image Count",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          288,
          624
        ],
        "notes": "word count √∑ 50"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://openrouter.ai/api/v1/chat/completions",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "openRouterApi",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "= {\n\n  \"model\": \"anthropic/claude-sonnet-4.6\",\n\n  \"messages\": [\n\n    {\n\n      \"role\": \"system\",\n\n     \"content\": \"You generate detailed watercolor painting image prompts for biblical contemplative sleep story videos. Each prompt MUST be 5+ sentences describing a dramatic, emotionally evocative watercolor scene.\\n\\nCRITICAL INSTRUCTION - CHRONOLOGICAL ORDER:\\n- Generate prompts in STRICT CHRONOLOGICAL ORDER following the script from beginning to end\\n- Each prompt should correspond to the narrative as it unfolds sequentially\\n- DO NOT jump around in the story or group similar themes together\\n- Follow the script paragraph by paragraph, section by section, in linear order\\n- The first prompt should depict the beginning of the script, the last prompt should depict the end\\n\\nSTYLE REQUIREMENTS:\\n- Dramatic Biblical watercolor painting style with soft, bleeding edges\\n- Contemplative, thoughtful, quietly beautiful tone\\n- Biblical/historical accuracy (Bronze Age settings, ancient clothing, period-appropriate materials)\\n- Deep purples, twilight blues, warm amber tones for nighttime atmosphere\\n- Focus on emotional weight, character expressions, symbolic elements\\n\\nCONTENT RESTRICTIONS (CRITICAL):\\n- NO violence, gore, blood, or weapons\\n- NO nudity or sexual content\\n- NO readable text or writing in images\\n- Use symbolic/atmospheric approaches when literal depictions would violate these rules\\n\\nOUTPUT FORMAT:\\nGenerate EXACTLY {{ $json.image_count }} prompts.\\nOutput ONLY a valid JSON array with no other text, markdown, or explanation:\\n[{\\\"prompt\\\": \\\"A Biblical watercolor painting of...\\\"}, {\\\"prompt\\\": \\\"A Biblical watercolor painting of...\\\"}]\\n\\nBase all prompts on the provided script IN THE ORDER IT IS WRITTEN.\"\n\n    },\n\n    {\n\n      \"role\": \"user\",\n\n      \"content\": {{ JSON.stringify($json.script) }}\n\n    }\n\n  ],\n\n  \"temperature\": 1,\n  \"max_tokens\": 28192\n\n} ",
          "options": {}
        },
        "id": "796e3dc3-7d62-48a0-85ea-624db13da506",
        "name": "Generate Prompts via OpenAI",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          496,
          624
        ],
        "credentials": {
          "openRouterApi": {
            "id": "VNgbdBR86ZkDETr5",
            "name": "OpenRouter account"
          }
        },
        "notes": "Creates all image prompts for this chapter"
      },
      {
        "parameters": {
          "jsCode": "const openaiResponse = $input.item.json.choices[0].message.content;\nlet prompts;\n\ntry {\n  prompts = JSON.parse(openaiResponse);\n} catch (e) {\n  const jsonMatch = openaiResponse.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    prompts = JSON.parse(jsonMatch[1]);\n  } else {\n    throw new Error(\"Could not parse OpenAI response as JSON\");\n  }\n}\n\nconst videoName = $('Loop Over Chapters').item.json.video_name;\nconst chapterNum = $('Loop Over Chapters').item.json.chapter_number;\nconst rowNumber = $('Loop Over Chapters').item.json.row_number;\n\n// Format for Sheet2 - each prompt as a separate row\nreturn prompts.map((p, index) => ({\n  json: {\n    video_name: videoName,\n    chapter_number: chapterNum,\n    image_number: String(index + 1).padStart(2, '0'),\n    filename: `${videoName}-${chapterNum}-${String(index + 1).padStart(2, '0')}.png`,\n    prompt: p.prompt,\n    status: 'pending',\n    chapter_row_number: rowNumber\n  }\n}));"
        },
        "id": "8e9e204a-5257-4ca8-adc4-ab58ec2ad123",
        "name": "Parse & Format for Sheet2",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          704,
          624
        ],
        "notes": "Formats each prompt as a row for Sheet2"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
            "mode": "list",
            "cachedResultName": "SFS Topic Input Sheet",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": 1502887379,
            "mode": "list",
            "cachedResultName": "Prompts",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1502887379"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "video_name": "={{ $json.video_name }}",
              "chapter_number": "={{ $json.chapter_number }}",
              "image_number": "={{ $json.image_number }}",
              "filename": "={{ $json.filename }}",
              "prompt": "={{ $json.prompt }}",
              "status": "pending"
            },
            "matchingColumns": [
              "filename"
            ],
            "schema": [
              {
                "id": "video_name",
                "displayName": "video_name",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "chapter_number",
                "displayName": "chapter_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "image_number",
                "displayName": "image_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "filename",
                "displayName": "filename",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "prompt",
                "displayName": "prompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "9c54ae8f-3968-41ba-85dd-1d8aa640f342",
        "name": "Write Prompts to Sheet2",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          288,
          848
        ],
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "1XqTJPtDuzHpqQbs",
            "name": "Google Sheets account"
          }
        },
        "notes": "Appends all prompts to Sheet2"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ",
            "mode": "list",
            "cachedResultName": "SFS Topic Input Sheet",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": 1287119606,
            "mode": "list",
            "cachedResultName": "Chapters",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17Je5LG46mogd9t3UOHllc8gzz8gQc5bgIuOSmJFhAyQ/edit#gid=1287119606"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "completed",
              "row_number": "={{ $('Loop Over Chapters').item.json.row_number }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "video_name",
                "displayName": "video_name",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "chapter_number",
                "displayName": "chapter_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "script",
                "displayName": "script",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "567f7ea1-924b-4b0d-886c-28694a39ecc5",
        "name": "Mark Chapter Complete (Sheet1)",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          544,
          848
        ],
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "1XqTJPtDuzHpqQbs",
            "name": "Google Sheets account"
          }
        },
        "notes": "Marks this chapter as completed in Sheet1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          288,
          464
        ],
        "id": "05420b1b-b47a-48af-890e-aa8fc352b847",
        "name": "Limit"
      },
      {
        "parameters": {
          "content": "## Workflow 1: Prompt Generation\n\n### What This Does:\n1. Reads pending chapters from Sheet1\n2. Calculates how many images needed (word count √∑ 50)\n3. Generates ALL prompts via OpenAI\n4. Writes prompts to Sheet2 with status='pending'\n5. Marks chapter as 'completed' in Sheet1\n\n### Sheet1 Columns:\nvideo_name, chapter_number, script, status, row_number\n\n### Sheet2 Columns:\nvideo_name, chapter_number, image_number, filename, prompt, status, row_number\n\n### Benefits:\n- Review/edit prompts before generating images\n- Separate prompt creation from expensive image generation\n- Only pay for image generation after reviewing prompts",
          "height": 532,
          "width": 440,
          "color": 5
        },
        "id": "75922f5b-59c2-40d2-a9e3-a8e6854e9d4c",
        "name": "Instructions1",
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -1104,
          528
        ]
      }
    ],
    "connections": {
      "Manual Trigger": {
        "main": [
          [
            {
              "node": "Get row(s) in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìù EDIT THIS - Your Input": {
        "main": [
          [
            {
              "node": "Read Google Doc",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Google Doc": {
        "main": [
          [
            {
              "node": "Parse Sections",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Sections": {
        "main": [
          [
            {
              "node": "Split Long Sections",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Write to Chapters Sheet": {
        "main": [
          [
            {
              "node": "Update row in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Long Sections": {
        "main": [
          [
            {
              "node": "Write to Chapters Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s) in sheet": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Read Pending Chapters (Sheet1)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Read Pending Chapters (Sheet1)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üìù EDIT THIS - Your Input",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update row in sheet": {
        "main": [
          [
            {
              "node": "Get a document",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get a document": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a message": {
        "main": [
          [
            {
              "node": "Get row(s) in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Get row(s) in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Pending Chapters (Sheet1)": {
        "main": [
          [
            {
              "node": "Loop Over Chapters",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Chapters": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Calculate Image Count",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculate Image Count": {
        "main": [
          [
            {
              "node": "Generate Prompts via OpenAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Prompts via OpenAI": {
        "main": [
          [
            {
              "node": "Parse & Format for Sheet2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse & Format for Sheet2": {
        "main": [
          [
            {
              "node": "Write Prompts to Sheet2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Write Prompts to Sheet2": {
        "main": [
          [
            {
              "node": "Mark Chapter Complete (Sheet1)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Mark Chapter Complete (Sheet1)": {
        "main": [
          [
            {
              "node": "Loop Over Chapters",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "ShaRhanda Lawson",
    "name": "Version 206ed2f7",
    "description": "change from medium close up shots to close up shots",
    "autosaved": true
  },
  "tags": [
    {
      "updatedAt": "2026-01-25T23:18:23.477Z",
      "createdAt": "2026-01-25T23:18:23.477Z",
      "id": "EYwjzgLoghqZQ2Du",
      "name": "SFS"
    }
  ]
}